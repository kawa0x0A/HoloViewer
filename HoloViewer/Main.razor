@inject ApplicationScreenMode ApplicationScreenMode

@using ScreenMode = ApplicationScreenMode.ScreenMode;

<ContentView>
    <StackLayout>
        <StackLayout Orientation="StackOrientation.Horizontal">
            <StackLayout Orientation="StackOrientation.Horizontal">
                <Label Text="画面分割" VerticalOptions="LayoutOptions.CenterAndExpand" FontSize="24" />
                @switch (Device.RuntimePlatform)
                {
                    case Device.WPF:
                        @foreach (var screenModeButtonInfo in screenModeButtonInfos)
                        {
                            <ImageButton Source="@(ImageSource.FromResource(screenModeButtonInfo.iconResourceName))" WidthRequest="@ScreenModeButtonInfo.IconWidthPixel" HeightRequest="@ScreenModeButtonInfo.IconHeightPixel" OnClick="@(() => ChangeScreenMode(screenModeButtonInfo.changeScreenMode))" />
                        }
                        break;

                    case Device.macOS:
                        @foreach (var screenModeButtonInfo in screenModeButtonInfos)
                        {
                            <Grid>
                                <Image Source="@(ImageSource.FromResource(screenModeButtonInfo.iconResourceName))" WidthRequest="@ScreenModeButtonInfo.IconWidthPixel" HeightRequest="@ScreenModeButtonInfo.IconHeightPixel" />
                                <TapGestureRecognizer OnTapped="@(() => ChangeScreenMode(screenModeButtonInfo.changeScreenMode))" />
                            </Grid>
                        }
                        break;
                }
            </StackLayout>
            @switch (Device.RuntimePlatform)
            {
                case Device.WPF:
                    <StackLayout Orientation="StackOrientation.Horizontal">
                        <Label Text="フルスクリーン" VerticalOptions="LayoutOptions.CenterAndExpand" FontSize="24" />
                        <Switch IsToggledChanged="ChangeWindowMode" VerticalOptions="LayoutOptions.CenterAndExpand" />
                    </StackLayout>
                    break;
            }

            <StackLayout Orientation="StackOrientation.Horizontal" HorizontalOptions="LayoutOptions.EndAndExpand" VerticalOptions="LayoutOptions.FillAndExpand">
                <Button Text="フィードバック" FontSize="24" VerticalOptions="LayoutOptions.Center" OnClick="ShowFeedBackDialog" />
                <Button Text="寄付" FontSize="24" VerticalOptions="LayoutOptions.Center" OnClick="OpenBillingPage" />
            </StackLayout>
        </StackLayout>

        @switch (ApplicationScreenMode.CurrentScreenMode)
        {
            case ScreenMode.Single:
                <Grid HorizontalOptions="LayoutOptions.FillAndExpand" VerticalOptions="LayoutOptions.FillAndExpand">
                    <BlazorWebView VerticalOptions="LayoutOptions.FillAndExpand">
                        <HoloViewer.WebUI.App />
                    </BlazorWebView>
                </Grid>
                break;

            case ScreenMode.SplitHorizontal2:
                <Grid RowDefinitions="*, *" HorizontalOptions="LayoutOptions.FillAndExpand" VerticalOptions="LayoutOptions.FillAndExpand">
                    <GridCell Row="0">
                        <BlazorWebView VerticalOptions="LayoutOptions.FillAndExpand">
                            <HoloViewer.WebUI.App />
                        </BlazorWebView>
                    </GridCell>
                    <GridCell Row="1">
                        <BlazorWebView VerticalOptions="LayoutOptions.FillAndExpand">
                            <HoloViewer.WebUI.App />
                        </BlazorWebView>
                    </GridCell>
                </Grid>
                break;

            case ScreenMode.SplitVertical2:
                <Grid ColumnDefinitions="*, *" HorizontalOptions="LayoutOptions.FillAndExpand" VerticalOptions="LayoutOptions.FillAndExpand">
                    <GridCell Column="0">
                        <BlazorWebView VerticalOptions="LayoutOptions.FillAndExpand">
                            <HoloViewer.WebUI.App />
                        </BlazorWebView>
                    </GridCell>
                    <GridCell Column="1">
                        <BlazorWebView VerticalOptions="LayoutOptions.FillAndExpand">
                            <HoloViewer.WebUI.App />
                        </BlazorWebView>
                    </GridCell>
                </Grid>
                break;

            case ScreenMode.SplitHorizontal3:
                <Grid RowDefinitions="*, *, *" HorizontalOptions="LayoutOptions.FillAndExpand" VerticalOptions="LayoutOptions.FillAndExpand">
                    <GridCell Row="0">
                        <BlazorWebView VerticalOptions="LayoutOptions.FillAndExpand">
                            <HoloViewer.WebUI.App />
                        </BlazorWebView>
                    </GridCell>
                    <GridCell Row="1">
                        <BlazorWebView VerticalOptions="LayoutOptions.FillAndExpand">
                            <HoloViewer.WebUI.App />
                        </BlazorWebView>
                    </GridCell>
                    <GridCell Row="2">
                        <BlazorWebView VerticalOptions="LayoutOptions.FillAndExpand">
                            <HoloViewer.WebUI.App />
                        </BlazorWebView>
                    </GridCell>
                </Grid>
                break;

            case ScreenMode.SplitVertical3:
                <Grid ColumnDefinitions="*, *, *" HorizontalOptions="LayoutOptions.FillAndExpand" VerticalOptions="LayoutOptions.FillAndExpand">
                    <GridCell Column="0">
                        <BlazorWebView VerticalOptions="LayoutOptions.FillAndExpand">
                            <HoloViewer.WebUI.App />
                        </BlazorWebView>
                    </GridCell>
                    <GridCell Column="1">
                        <BlazorWebView VerticalOptions="LayoutOptions.FillAndExpand">
                            <HoloViewer.WebUI.App />
                        </BlazorWebView>
                    </GridCell>
                    <GridCell Column="2">
                        <BlazorWebView VerticalOptions="LayoutOptions.FillAndExpand">
                            <HoloViewer.WebUI.App />
                        </BlazorWebView>
                    </GridCell>
                </Grid>
                break;

            case ScreenMode.SplitCustom3_1:
                <Grid RowDefinitions="*, *" ColumnDefinitions="*, *" HorizontalOptions="LayoutOptions.FillAndExpand" VerticalOptions="LayoutOptions.FillAndExpand">
                    <GridCell Row="0" Column="0" ColumnSpan="2">
                        <BlazorWebView VerticalOptions="LayoutOptions.FillAndExpand">
                            <HoloViewer.WebUI.App />
                        </BlazorWebView>
                    </GridCell>
                    <GridCell Row="1" Column="0">
                        <BlazorWebView VerticalOptions="LayoutOptions.FillAndExpand">
                            <HoloViewer.WebUI.App />
                        </BlazorWebView>
                    </GridCell>
                    <GridCell Row="1" Column="1">
                        <BlazorWebView VerticalOptions="LayoutOptions.FillAndExpand">
                            <HoloViewer.WebUI.App />
                        </BlazorWebView>
                    </GridCell>
                </Grid>
                break;

            case ScreenMode.SplitCustom3_2:
                <Grid RowDefinitions="*, *" ColumnDefinitions="*, *" HorizontalOptions="LayoutOptions.FillAndExpand" VerticalOptions="LayoutOptions.FillAndExpand">
                    <GridCell Row="0" Column="0">
                        <BlazorWebView VerticalOptions="LayoutOptions.FillAndExpand">
                            <HoloViewer.WebUI.App />
                        </BlazorWebView>
                    </GridCell>
                    <GridCell Row="0" Column="1">
                        <BlazorWebView VerticalOptions="LayoutOptions.FillAndExpand">
                            <HoloViewer.WebUI.App />
                        </BlazorWebView>
                    </GridCell>
                    <GridCell Row="1" Column="0" ColumnSpan="2">
                        <BlazorWebView VerticalOptions="LayoutOptions.FillAndExpand">
                            <HoloViewer.WebUI.App />
                        </BlazorWebView>
                    </GridCell>
                </Grid>
                break;

            case ScreenMode.SplitHorizontal4:
                <Grid RowDefinitions="*, *, *, *" HorizontalOptions="LayoutOptions.FillAndExpand" VerticalOptions="LayoutOptions.FillAndExpand">
                    <GridCell Row="0">
                        <BlazorWebView VerticalOptions="LayoutOptions.FillAndExpand">
                            <HoloViewer.WebUI.App />
                        </BlazorWebView>
                    </GridCell>
                    <GridCell Row="1">
                        <BlazorWebView VerticalOptions="LayoutOptions.FillAndExpand">
                            <HoloViewer.WebUI.App />
                        </BlazorWebView>
                    </GridCell>
                    <GridCell Row="2">
                        <BlazorWebView VerticalOptions="LayoutOptions.FillAndExpand">
                            <HoloViewer.WebUI.App />
                        </BlazorWebView>
                    </GridCell>
                    <GridCell Row="3">
                        <BlazorWebView VerticalOptions="LayoutOptions.FillAndExpand">
                            <HoloViewer.WebUI.App />
                        </BlazorWebView>
                    </GridCell>
                </Grid>
                break;

            case ScreenMode.SplitVertical4:
                <Grid ColumnDefinitions="*, *, *, *" HorizontalOptions="LayoutOptions.FillAndExpand" VerticalOptions="LayoutOptions.FillAndExpand">
                    <GridCell Column="0">
                        <BlazorWebView VerticalOptions="LayoutOptions.FillAndExpand">
                            <HoloViewer.WebUI.App />
                        </BlazorWebView>
                    </GridCell>
                    <GridCell Column="1">
                        <BlazorWebView VerticalOptions="LayoutOptions.FillAndExpand">
                            <HoloViewer.WebUI.App />
                        </BlazorWebView>
                    </GridCell>
                    <GridCell Column="2">
                        <BlazorWebView VerticalOptions="LayoutOptions.FillAndExpand">
                            <HoloViewer.WebUI.App />
                        </BlazorWebView>
                    </GridCell>
                    <GridCell Column="3">
                        <BlazorWebView VerticalOptions="LayoutOptions.FillAndExpand">
                            <HoloViewer.WebUI.App />
                        </BlazorWebView>
                    </GridCell>
                </Grid>
                break;

            case ScreenMode.SplitCustom4:
                <Grid RowDefinitions="*, *" ColumnDefinitions="*, *" HorizontalOptions="LayoutOptions.FillAndExpand" VerticalOptions="LayoutOptions.FillAndExpand">
                    <GridCell Row="0" Column="0">
                        <BlazorWebView VerticalOptions="LayoutOptions.FillAndExpand">
                            <HoloViewer.WebUI.App />
                        </BlazorWebView>
                    </GridCell>
                    <GridCell Row="0" Column="1">
                        <BlazorWebView VerticalOptions="LayoutOptions.FillAndExpand">
                            <HoloViewer.WebUI.App />
                        </BlazorWebView>
                    </GridCell>
                    <GridCell Row="1" Column="0">
                        <BlazorWebView VerticalOptions="LayoutOptions.FillAndExpand">
                            <HoloViewer.WebUI.App />
                        </BlazorWebView>
                    </GridCell>
                    <GridCell Row="1" Column="1">
                        <BlazorWebView VerticalOptions="LayoutOptions.FillAndExpand">
                            <HoloViewer.WebUI.App />
                        </BlazorWebView>
                    </GridCell>
                </Grid>
                break;
        }

    </StackLayout>
</ContentView>


@code
{
    public class ScreenModeButtonInfo
    {
        public delegate void OnClickFunction ();

        public readonly string iconResourceName;
        public readonly ScreenMode changeScreenMode;
        public const int IconWidthPixel = 32;
        public const int IconHeightPixel = 32;

        public ScreenModeButtonInfo (string iconResourceName, ScreenMode changeScreenMode)
        {
            this.iconResourceName = iconResourceName;
            this.changeScreenMode = changeScreenMode;
        }
    }

    public static readonly ScreenModeButtonInfo[] screenModeButtonInfos =
    {
        new ScreenModeButtonInfo("HoloViewer.Resources.Icon.IconScreenSingle.png", ScreenMode.Single),
        new ScreenModeButtonInfo("HoloViewer.Resources.Icon.IconScreenHorizontal2.png", ScreenMode.SplitHorizontal2),
        new ScreenModeButtonInfo("HoloViewer.Resources.Icon.IconScreenVertical2.png", ScreenMode.SplitVertical2),
        new ScreenModeButtonInfo("HoloViewer.Resources.Icon.IconScreenHorizontal3.png", ScreenMode.SplitHorizontal3),
        new ScreenModeButtonInfo("HoloViewer.Resources.Icon.IconScreenVertical3.png", ScreenMode.SplitVertical3),
        new ScreenModeButtonInfo("HoloViewer.Resources.Icon.IconScreenCustom3-1.png", ScreenMode.SplitCustom3_1),
        new ScreenModeButtonInfo("HoloViewer.Resources.Icon.IconScreenCustom3-2.png", ScreenMode.SplitCustom3_2),
        new ScreenModeButtonInfo("HoloViewer.Resources.Icon.IconScreenHorizontal4.png", ScreenMode.SplitHorizontal4),
        new ScreenModeButtonInfo("HoloViewer.Resources.Icon.IconScreenVertical4.png", ScreenMode.SplitVertical4),
        new ScreenModeButtonInfo("HoloViewer.Resources.Icon.IconScreenCustom4.png", ScreenMode.SplitCustom4),
    };

    void ChangeScreenMode (ScreenMode screenMode)
    {
        ApplicationScreenMode.ChangeScreenMode(screenMode);
    }

    void ChangeWindowMode (bool isToggle)
    {
        var windowMode = DependencyService.Get<IWindowMode>();

        if (isToggle)
        {
            windowMode.FullScreen();
        }
        else
        {
            windowMode.WindowMode();
        }
    }

    void ShowFeedBackDialog ()
    {
        var feedBackDialog = DependencyService.Get<IFeedBackDialog>();

        feedBackDialog.ShowDialog();
    }

    void OpenBillingPage ()
    {
        var billingPage = DependencyService.Get<IBillingPage>();

        billingPage.OpenPage();
    }
}
